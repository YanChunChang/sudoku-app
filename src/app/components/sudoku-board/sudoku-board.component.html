<form class="board" [formGroup]="form">
    <div class="wrapper">
        <app-timer [mode]="timerMode" [startFrom]="timerValue"></app-timer>
        <div class="right">
            <p-button icon="pi pi-eraser" (click)="onClickReset()"></p-button>
            <p-button icon="pi pi-chevron-right" (click)="onClickNewgame()"></p-button>
        </div>
    </div>
    <div class="board-wrapper">
        <div formArrayName="board" class="grid-container">
            <ng-container *ngFor="let row of rowControls; let r = index">
                <div *ngFor="let cell of row.controls; let c = index" class="grid-item" [ngClass]="{
                    'border-bottom-bold': (r + 1) % 3 === 0 && r !== 8,
                    'border-right-bold': (c + 1) % 3 === 0 && c !== 8,
                    'block-a': getBlockClass(r, c) === 'a',
                    'block-b': getBlockClass(r, c) === 'b'
                  }">
                    <input id="cell-{{r}}-{{c}}" autocomplete="off" [readonly]=" this.initialBoard[r][c] !== 0"
                        [attr.tabindex]="this.initialBoard[r][c] !== 0 ? -1 : 0" [formControl]="getCell(r, c)"
                        (input)="checkCellAnswer(r, c)" [ngClass]="getCellClass(r, c)" maxlength="1"
                        (keydown)="onKeyDown($event, r, c)" />
                </div>
            </ng-container>
        </div>
        <!-- Das Overlay -->
        <div class="covered" *ngIf="isPaused">
            <button pButton icon="pi pi-play" class="resume-button" (click)="onResume()"></button>
        </div>
    </div>
</form>

<p-dialog header="{{ 'DIALOG_NICKNAME.HEADER' | translate }}" [(visible)]="showNicknameDialog" [modal]="true" [closable]="false">
    <div class="p-fluid">
      <div class="p-field">
        <label>{{ 'DIALOG_NICKNAME.TEXT' | translate }}</label>
        <input type="text" [(ngModel)]="nickname" placeholder="King Otter" maxlength="20">
      </div>
      <a (click)="submitScore()">{{ 'DIALOG_NICKNAME.SUBMIT' | translate }}</a>
      <a (click)="onSkip()" showGameWonDialog = "false">{{ 'DIALOG_NICKNAME.SKIP' | translate }}</a>
    </div>
</p-dialog>

<p-dialog header="{{ 'DIALOG.HEADER' | translate }}" [(visible)]="showGameWonDialog" modal="true" [closable]="false">
    <div class="p-text">
        <p>{{ 'DIALOG.TEXT' | translate }}</p>
    </div>
    <a (click)="onClickNewgame()" showGameWonDialog = "false">{{ 'DIALOG.BUTTON_NEXT_GAME' | translate }}</a>
    <a (click)="onClickNextLevel()">{{ 'DIALOG.BUTTON_NEXT_LEVEL' | translate }}</a>
    <a (click)="onClickRandomGame()" showGameWonDialog = "false">{{ 'DIALOG.BUTTON_RANDOM' | translate }}</a>
    <a [routerLink]="['/leaderboard']" [queryParams]="{
        playerMode: currentPlayerMode,
        playMode: currentPlayMode,
        level: currentLevel
       }">
        View Full Leaderboard
    </a>
</p-dialog>

<p-toast />